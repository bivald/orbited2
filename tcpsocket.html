<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        
        <title>
            
    
                TCP Socket
             &mdash; 
    orbited2 0.2.0 documentation

        </title>
        
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/docs.css" type="text/css" />

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '#',
          VERSION:     '0.2.0',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/init.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="orbited2 0.2.0 documentation" href="index.html" />
        <link rel="prev" title="Compilation" href="compilation.html" />

    </head>
    <body>
        










<div id="docs-container">



<div id="docs-header">
    <h1>orbited2 0.2.0 documentation</h1>

    <div id="docs-search">
    Search:
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" /> <input type="submit" value="Search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>

    <div id="docs-version-header">
        Release: <span class="version-num">0.2.0</span> | Release Date: 


    </div>

</div>

<div id="docs-top-navigation">
    <div id="docs-top-page-control" class="docs-navigation-links">
        <ul>
            <li>Prev:
            <a href="compilation.html" title="previous chapter">Compilation</a>
            </li>

        <li>
            <a href="contents.html">Table of Contents</a> |
            <a href="genindex.html">Index</a>
            | <a href="_sources/tcpsocket.txt">view source
        </li>
        </ul>
    </div>

    <div id="docs-navigation-banner">
        <a href="index.html">orbited2 0.2.0 documentation</a>
        » 
                TCP Socket
             

        <h2>
            
                TCP Socket
            
        </h2>
    </div>

</div>

<div id="docs-body-container">

    <div id="docs-sidebar">
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">TCP Socket</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
</ul>
</li>
</ul>


    <h4>Previous Topic</h4>
    <p>
    <a href="compilation.html" title="previous chapter">Compilation</a>
    </p>


    <h4>Quick Search</h4>
    <p>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" /> <input type="submit" value="Search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </p>

    </div>

    <div id="docs-body" class="withsidebar" >
        
<div class="section" id="tcp-socket">
<h1>TCP Socket<a class="headerlink" href="#tcp-socket" title="Permalink to this headline">¶</a></h1>
<p>Orbited has two main functions: cross-browser web socket and TCP socket. TCP Socket is a bridge between the browser (javascript) and a TCP service on the other side of Orbited (this can be a STOMP service, IRC service, your own TCP service etc.).</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">sock</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Orbited2</span><span class="p">.</span><span class="nx">TCPSocket</span><span class="p">({</span> <span class="nx">orbitedUri</span><span class="o">:</span> <span class="s2">&quot;http://127.0.0.1:8000&quot;</span><span class="p">,</span> <span class="nx">forceTransport</span><span class="o">:</span> <span class="s2">&quot;csp&quot;</span> <span class="p">})</span>
<span class="nx">sock</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;irc.freenode.org&quot;</span><span class="p">,</span> <span class="mi">6667</span><span class="p">);</span>
<span class="nx">sock</span><span class="p">.</span><span class="nx">onopen</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">sock</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;NICK mcarter\r\n&#39;</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">//etc</span></pre></div>
</div>
<p>If we break it down:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">sock</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Orbited2</span><span class="p">.</span><span class="nx">TCPSocket</span><span class="p">({</span> <span class="nx">orbitedUri</span><span class="o">:</span> <span class="s2">&quot;http://127.0.0.1:8000&quot;</span><span class="p">,</span> <span class="nx">forceTransport</span><span class="o">:</span> <span class="s2">&quot;csp&quot;</span> <span class="p">})</span></pre></div>
</div>
<p>This creates a new Orbited2 TCPSocket. Options:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="nx">orbitedUri</span><span class="o">:</span> <span class="s2">&quot;http://127.0.0.1:8000&quot;</span><span class="p">,</span>
  <span class="nx">forceTransport</span><span class="o">:</span> <span class="s2">&quot;csp&quot;</span>
<span class="p">}</span></pre></div>
</div>
<p>orbitedUri: URI and port to orbited. This can be either HTTP or (experimental) HTTPs
forceTransport: Should orbited let the browser choose the best transport (using websockets if possible, or old-school &#8220;csp&#8221;). Currently there are know issues with the ws protocol, thus we recommend using &#8220;csp&#8221;.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">sock</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;irc.freenode.org&quot;</span><span class="p">,</span> <span class="mi">6667</span><span class="p">);</span></pre></div>
</div>
<p>Parameters are:</p>
<blockquote>
<div>sock.open(server_adress, server_port, binary_protocol);</div></blockquote>
<p>server_adress: The address for Orbited to connect to
server_port: The port for Orbited to connect to
binary_protocol: Is the data binary or text? If you plan to send binary data such as images over Orbited, this should be set to true. If you plan to only send text (as in when connecting to an irc server) binary should be set to false.</p>
<p>Also, when set to binary Orbited does not handle string encoding at all. It&#8217;s worth noting here that browsers do not use UTF-8 internally, but UTF-16. So if you plan to use binary protocol, unless you want utf-16, we recommend you to decode to utf-8 before sending it via the socket (sock.send). How to do this can be read on <a class="reference external" href="https://gist.github.com/2780226">https://gist.github.com/2780226</a> (thanks to Philip Bennefall for pointing this out)</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">sock</span><span class="p">.</span><span class="nx">onopen</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="c1">// handle server connects here</span>
<span class="p">}</span></pre></div>
</div>
<p>onopen is called when the server has established the connection to the end remote service. If connecting to an IRC server, this would be the right time to send the initial commands (such as NICK, USER etc.). Remember, if your server is a line-separated protocol such as IRC, you need to send  &#8220;n&#8221; at the end.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">sock</span><span class="p">.</span><span class="nx">onclose</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
   <span class="c1">// handle server disconnects here, triggered by a variety of reasons (remote server closed the connection, pinged out, etc. )</span>
<span class="p">}</span></pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">sock</span><span class="p">.</span><span class="nx">onread</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="p">{</span>
   <span class="c1">// handle server data here</span>
<span class="p">}</span></pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">sock</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span></pre></div>
</div>
<p>Remember, when sock.open is set to binary Orbited does not handle string encoding at all. It&#8217;s worth noting here that browsers do not use UTF-8 internally, but UTF-16. So if you plan to use binary protocol, unless you want utf-16, we recommend you to decode to utf-8 before sending it via the socket (sock.send). How to do this can be read on <a class="reference external" href="https://gist.github.com/2780226">https://gist.github.com/2780226</a> (thanks to Philip Bennefall for pointing this out)</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">sock</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span></pre></div>
</div>
<p>Closes the socket. Will trigger .onclose()</p>
</div>
</div>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links">
        Previous:
        <a href="compilation.html" title="previous chapter">Compilation</a>

    <div id="docs-copyright">
        &copy; Copyright 2012, Michael Carter.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
</div>

</div>

        
    </body>
</html>


